<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Our tariffs</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <h1 class="text-center mt-5">Мы можем предложить следующие тарифы</h1>
    <table id="tariffTable" class="table table-striped table-fixed mt-4">
        <colgroup>
            <col style="width: 20%">
            <col style="width: 30%">
            <col style="width: 30%">
            <col style="width: 20%">
        </colgroup>
        <thead>
        <tr>
            <th>№</th>
            <th>Тип</th>
            <th>Процентная ставка</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td colspan="4">Loading tariffs...</td>
        </tr>
        </tbody>
    </table>

    <br>

    <div class="text-center">
        <a href="http://localhost:8080/loan-service/getTariffs" class="btn btn-primary">
            Посмотреть JSON
        </a>
    </div>

    <br>

    <div class="text-center">
        <a href="http://localhost:8080/" class="btn btn-secondary">
            На главную
        </a>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
    $(document).ready(function() {
        $.ajax({
            url: "/loan-service/getTariffs",
            type: "GET",
            dataType: "json",
            success: function(response) {
                var data = response.data;
                // обработка данных и отображение на странице
                var tariffTable = $("#tariffTable tbody");
                tariffTable.empty(); // очистка таблицы перед заполнением новыми данными
                if (data.tariffs.length == 0) {
                    tariffTable.append("<tr><td colspan='4'>No tariffs available</td></tr>");
                } else {
                    $.each(data.tariffs, function(index, tariff) {
                        tariffTable.append("<tr><td>" + tariff.id + "</td><td>" + tariff.type + "</td><td>" + tariff.interest_rate + "</td><td><a href='/loan-service/getLoan?id=" + tariff.id + "' class='btn btn-success'>Взять этот кредит</a></td></tr>");
                    });
                }
            },

            error: function(jqXHR, textStatus, errorThrown) {
                console.log(textStatus, errorThrown);
            }
        });
    });
</script>



</body>
</html>